{% if forloop.first %} <!-- switched from unless post.next to forloop.first because of issues -->
<div class="archive__element__frame">
  <div class="archive__element">
    <h3>{{ post.date | date: '%Y' }}</h3>
  </div>
  <div class="archive__box">
{% else %}
  {% capture year %}{{ post.date | date: '%Y' }}{% endcapture %}
  {% capture nyear %}{{ post.next.date | date: '%Y' }}{% endcapture %}
  {% if year != nyear %}

    </div>
  </div>
  <div class="archive__element__frame">
    <div class="archive__element">
      <h3>{{ post.date | date: '%Y' }}</h3>
    </div>
    <div class="archive__box">
  {% endif %}
{% endif %} <!-- switched from unless post.next to forloop.first because of issues -->
      <div class="archive__item">
        <div class="item__time">
          <time>{{ post.date | date:"%d %b" }}</time>
        </div>
        <div class="item__info">
          <div class="item__info_1">
            {% if post.sub_title %}
            <div class="info_1_subtitle">
              <a href="{{ post.url }}">
                [ {{ post.sub_title }} ]
              </a>
            </div>
            {% endif %}
            <div class="info_1_title">
              <a href="{{ post.url }}">
                {{ post.title }}
              </a>
            </div>
          </div>
          {% if post.tags %}
          <div class="item__info_2">
            {% for tag in post.tags %}
              <span>{{tag}}</span>
            {% endfor %}
          </div>
          {% endif %}
        </div>
      </div>
